<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://ingo-richter.io/images/favicon.png><title>Testing raw DOM Event Handler in Reactjs&nbsp;|&nbsp;Today is Tomorrow's Past</title><meta name=title content="Testing raw DOM Event Handler in Reactjs"><meta name=description content="This is a reminder to myself. And to anybody who needs a creative solution to test an event handler directly attached to a DOM node of a react component.
Last Friday I ran into the situation to test my react component to ensure that the state updates correctly when the pointerenter and pointerleave event fires.
Testing for these events is usually no big deal when you use reactjs in one way or the other (either web or native). At work we use an internal framework that is react API compatible and implements most of the features of react. Most of them, but not all."><meta name=keywords content="Reactjs,Programming,Testing,DontForget,"><meta name=author content="Ingo Richter"><meta property="og:url" content="https://ingo-richter.io/post/testing-dom-event-handler-in-reactjs/"><meta property="og:site_name" content="Today is Tomorrow's Past"><meta property="og:title" content="Testing raw DOM Event Handler in Reactjs"><meta property="og:description" content="This is a reminder to myself. And to anybody who needs a creative solution to test an event handler directly attached to a DOM node of a react component.
Last Friday I ran into the situation to test my react component to ensure that the state updates correctly when the pointerenter and pointerleave event fires. Testing for these events is usually no big deal when you use reactjs in one way or the other (either web or native). At work we use an internal framework that is react API compatible and implements most of the features of react. Most of them, but not all."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2018-08-12T16:38:57-07:00"><meta property="article:modified_time" content="2018-08-12T16:38:57-07:00"><meta property="article:tag" content="Reactjs"><meta property="article:tag" content="Programming"><meta property="article:tag" content="Testing"><meta property="article:tag" content="DontForget"><meta name=twitter:card content="summary"><meta name=twitter:title content="Testing raw DOM Event Handler in Reactjs"><meta name=twitter:description content="This is a reminder to myself. And to anybody who needs a creative solution to test an event handler directly attached to a DOM node of a react component.
Last Friday I ran into the situation to test my react component to ensure that the state updates correctly when the pointerenter and pointerleave event fires. Testing for these events is usually no big deal when you use reactjs in one way or the other (either web or native). At work we use an internal framework that is react API compatible and implements most of the features of react. Most of them, but not all."><meta itemprop=name content="Testing raw DOM Event Handler in Reactjs"><meta itemprop=description content="This is a reminder to myself. And to anybody who needs a creative solution to test an event handler directly attached to a DOM node of a react component.
Last Friday I ran into the situation to test my react component to ensure that the state updates correctly when the pointerenter and pointerleave event fires. Testing for these events is usually no big deal when you use reactjs in one way or the other (either web or native). At work we use an internal framework that is react API compatible and implements most of the features of react. Most of them, but not all."><meta itemprop=datePublished content="2018-08-12T16:38:57-07:00"><meta itemprop=dateModified content="2018-08-12T16:38:57-07:00"><meta itemprop=wordCount content="448"><meta itemprop=keywords content="Reactjs,Programming,Testing,DontForget"><meta name=referrer content="no-referrer-when-downgrade"><link href=https://ingo-richter.io/bundle.min.css rel=stylesheet><link rel=alternate type=application/rss+xml href=https://ingo-richter.io/post/testing-dom-event-handler-in-reactjs/index.xml title="Today is Tomorrow's Past"><meta name=fediverse:creator content="@ingorichter@mastodon.social"><script src=https://ingo-richter.io/js/scripts.min.js></script></head><body><header><nav><a href=https://ingo-richter.io/>Home</a>
<a href=https://ingo-richter.io/about/>About</a>
<a href=https://ingo-richter.io/resume/resume.pdf>Resume</a>
<a href=https://ingo-richter.io/post/>Posts</a>
<a href=https://ingo-richter.io/cv19wfh/>CV19WFH</a>
<a href=https://ingo-richter.io/wallpaper/>Wallpaper</a>
<a href=https://ingo-richter.io/categories/>Categories</a>
<a href=https://ingo-richter.io/now/>Now</a>
<a href=https://ingo-richter.io/index.xml><svg class="icon" viewBox="0 0 448 512"><path d="M0 64C0 46.3 14.3 32 32 32c229.8.0 416 186.2 416 416 0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96 14.3 96 0 81.7.0 64zM0 416a64 64 0 11128 0A64 64 0 110 416zM32 160c159.1.0 288 128.9 288 288 0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224-17.7.0-32-14.3-32-32s14.3-32 32-32z"/></svg>
RSS</a></nav><h1>Testing raw DOM Event Handler in Reactjs</h1></header><main><content class=published-date>Published on <time datetime=2018-08-12T16:38:57-07:00>Sunday, August 12, 2018</time>
</content><content><p>This is a reminder to myself. And to anybody who needs a creative solution to test an event handler directly attached to a DOM node of a react component.</p><p>Last Friday I ran into the situation to test my react component to ensure that the state updates correctly when the <code>pointerenter</code> and <code>pointerleave</code> event fires.
Testing for these events is usually no big deal when you use reactjs in one way or the other (either web or native). At work we use an internal framework that is react API compatible and implements most of the features of react. Most of them, but not all.</p><p>I ran into the situation where I have the <code>pointerenter</code> event handler defined, but they didn&rsquo;t fire. The team recommended to replace it with an event handler directly attached to the DOM node by</p><ul><li>assign a ref to the component</li><li>attach the event handler to the ref</li></ul><p>This is how it looked like<div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 1</span><span><span style=color:#cba6f7>class</span> ImageHover <span style=color:#cba6f7>extends</span> React.Component {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 2</span><span> constructor(props) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 3</span><span>  <span style=color:#cba6f7>super</span>(props);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 4</span><span>  
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 5</span><span>  <span style=color:#cba6f7>this</span>._hoverBoxRef <span style=color:#89dceb;font-weight:700>=</span> React.CreateRef();
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 6</span><span> }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 7</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 8</span><span> <span style=color:#f38ba8>function</span> _toggleHoverState <span style=color:#89dceb;font-weight:700>=</span> (state) =&gt; {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 9</span><span>  <span style=color:#cba6f7>this</span>.setState({ isNormal<span style=color:#89dceb;font-weight:700>:</span> state });
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">10</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">11</span><span>  <span style=color:#f38ba8>function</span> componentDidMount() {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">12</span><span>    <span style=color:#cba6f7>this</span>._hoverBoxRef.current.addEventListener(<span style=color:#a6e3a1>&#39;pointerenter&#39;</span>, () =&gt; <span style=color:#cba6f7>this</span>._toggleHoverState(<span style=color:#fab387>false</span>));
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">13</span><span>    <span style=color:#cba6f7>this</span>._hoverBoxRef.current.addEventListener(<span style=color:#a6e3a1>&#39;pointerleave&#39;</span>, () =&gt; <span style=color:#cba6f7>this</span>._toggleHoverState(<span style=color:#fab387>true</span>));
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">14</span><span>  }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">15</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">16</span><span>  <span style=color:#f38ba8>function</span> componentWillUnmount() {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">17</span><span>    <span style=color:#cba6f7>this</span>._hoverBoxRef.current.removeEventListener(<span style=color:#a6e3a1>&#39;pointerenter&#39;</span>, () =&gt; <span style=color:#cba6f7>this</span>._toggleHoverState(<span style=color:#fab387>false</span>));
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">18</span><span>    <span style=color:#cba6f7>this</span>._hoverBoxRef.current.removeEventListener(<span style=color:#a6e3a1>&#39;pointerleave&#39;</span>, () =&gt; <span style=color:#cba6f7>this</span>._toggleHoverState(<span style=color:#fab387>true</span>));
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">19</span><span>  }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">20</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">21</span><span> render () {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">22</span><span>  style <span style=color:#89dceb;font-weight:700>=</span> <span style=color:#cba6f7>this</span>.state.isNormal <span style=color:#89dceb;font-weight:700>?</span> <span style=color:#a6e3a1>&#34;normal&#34;</span> <span style=color:#89dceb;font-weight:700>:</span> <span style=color:#a6e3a1>&#34;hover&#34;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">23</span><span>  <span style=color:#cba6f7>return</span> (
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">24</span><span>   &lt;<span style=color:#cba6f7>div</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">25</span><span>    <span style=color:#89b4fa>className</span><span style=color:#89dceb;font-weight:700>=</span>{ style }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">26</span><span>    <span style=color:#89b4fa>onClick</span><span style=color:#89dceb;font-weight:700>=</span>{<span style=color:#cba6f7>this</span>.props.onClick}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">27</span><span>    <span style=color:#89b4fa>ref</span><span style=color:#89dceb;font-weight:700>=</span>{<span style=color:#cba6f7>this</span>._hoverBoxRef}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">28</span><span>    /&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">29</span><span>  );
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">30</span><span> }</span></span></code></pre></div></p><p>To ensure that the component changes the style to <code>hover</code> when the <code>pointerenter</code> event fires and back to <code>normal</code> when <code>pointerleave</code> is fired can usually achieved by using the rendered component and call <code>.simulate("pointerEnter")</code> when using jest and enzyme.</p><p>Normal test</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">1</span><span>cb <span style=color:#89dceb;font-weight:700>=</span> jest.fn();
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">2</span><span>imageHover <span style=color:#89dceb;font-weight:700>=</span> mount(&lt;<span style=color:#cba6f7>ImageHover</span> <span style=color:#89b4fa>imageName</span><span style=color:#89dceb;font-weight:700>=</span>{<span style=color:#a6e3a1>&#34;phone&#34;</span>} <span style=color:#89b4fa>onClick</span><span style=color:#89dceb;font-weight:700>=</span>{cb} /&gt;);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">4</span><span>it(<span style=color:#a6e3a1>&#34;should change state on pointerEnter&#34;</span>, () =&gt; {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">5</span><span> imageHover.simulate(<span style=color:#a6e3a1>&#34;pointerEnter&#34;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">6</span><span> expect(imageHover.state().isNormal).toEqual(<span style=color:#fab387>false</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">7</span><span>});</span></span></code></pre></div><p>Since the <code>pointerEnter</code> event didn&rsquo;t fire in my situation, I had to find another way to trigger that event. Here is the modified test</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">1</span><span>cb <span style=color:#89dceb;font-weight:700>=</span> jest.fn();
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">2</span><span>imageHover <span style=color:#89dceb;font-weight:700>=</span> mount(&lt;<span style=color:#cba6f7>ImageHover</span> <span style=color:#89b4fa>imageName</span><span style=color:#89dceb;font-weight:700>=</span>{<span style=color:#a6e3a1>&#34;phone&#34;</span>} <span style=color:#89b4fa>onClick</span><span style=color:#89dceb;font-weight:700>=</span>{cb} /&gt;);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">4</span><span>it(<span style=color:#a6e3a1>&#34;should change state on pointerEnter&#34;</span>, () =&gt; {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">5</span><span> <span style=color:#cba6f7>const</span> domNode <span style=color:#89dceb;font-weight:700>=</span> imageHover.getDOMNode();
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">6</span><span> <span style=color:#cba6f7>const</span> event <span style=color:#89dceb;font-weight:700>=</span> <span style=color:#cba6f7>new</span> Event(<span style=color:#a6e3a1>&#34;pointerenter&#34;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">7</span><span> domNode.dispatchEvent(event);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">8</span><span> expect(imageHover.state().isNormal).toEqual(<span style=color:#fab387>false</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">9</span><span>});</span></span></code></pre></div><p>The tiny difference is getting access to the underlying DOM element during the test execution and dispatch the <code>pointerenter</code> event on that DOM node.
I&rsquo;ve omitted the event details in this example since they aren&rsquo;t relevant for the demo purpose. Perhaps there is an alternative solution to achieve the same result without the direct DOM access. Let me know, and I&rsquo;m happy to update my test code.</p><p><strong>Thank you very much for reading!</strong></p></content><p><a href=https://ingo-richter.io/blog/reactjs/>#Reactjs</a>&nbsp;&nbsp;
<a href=https://ingo-richter.io/blog/programming/>#Programming</a>&nbsp;&nbsp;
<a href=https://ingo-richter.io/blog/testing/>#Testing</a>&nbsp;&nbsp;
<a href=https://ingo-richter.io/blog/dontforget/>#DontForget</a>&nbsp;&nbsp;</p><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//ingorichterio.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></main><footer><span>© 2025 Ingo Richter</span>
<span>|
Made with
<a href=https://github.com/maolonglong/hugo-simple/>Hugo ʕ•ᴥ•ʔ Simple</a></span></footer><script id=analytics async src=https://umami.familie-richter.de/script.js data-website-id=98a5f2cb-a53b-4d84-9133-bac4957e9e9f></script></body></html>